<!--Error dialogue-->
<amexio-window [show-window]="errorFlag"
               [header]="true"
			   [footer]="true" 
			   [draggable]="true" 
			   [vertical-position]="'center'" 
			   [horizontal-position]="'center'" 
			   [closable]="false"
               >
	<amexio-header>
        <i class="fa fa-exclamation-triangle"></i> Ошибка
      </amexio-header>
	   <amexio-body>
        <amexio-row>
          <amexio-column [size]="11">
		  <span style="color:red">{{errorMessage}}</span>
		  </amexio-column>
        </amexio-row>
	</amexio-body> 
	<amexio-action> 
	<amexio-row> 
	<amexio-column size="11"> 
     <amexio-button  [label]="'Ok'" (onClick)="errorFlag=false" [type]="'red'" [tooltip]="'Ok'" [icon]="'fa fa-exclamation-triangle'"></amexio-button>
	</amexio-column> 
	</amexio-row> 
	</amexio-action> 
</amexio-window>
<!-- edit row pane -->	 
 <amexio-window [closable]="false" [maximize]="true" [vertical-position]="'center'"    [horizontal-position]="'center'"  [draggable]="true" [remember-window-position]="true" [width]="'auto'"  amexioThemeStyle  [theme-style]="'round-edge'"  [show-window]="opened" [header]="true" [footer]="true" > 
	  <amexio-header> 
        {{formMsg}} Пользователь::Описание 
<amexio-box *ngIf="valid==false" border-color ="red" border="all" padding="true" background-color="yellow">
	<amexio-label font-color="red"  border="bottom">Ошибка заполнения формы</amexio-label>
</amexio-box>
      </amexio-header> 
     <amexio-body> 
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Фамилия'" name ="family"  
                    [place-holder] = "'Фамилия'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.family" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Имя'" name ="name"  
                    [place-holder] = "'Имя'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.name" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Отчество'" name ="middleName"  
                    [place-holder] = "'Отчество'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.middleName" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Имя для входа'" name ="login"  
                    [place-holder] = "'Имя для входа'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.login" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Пароль'" name ="password"  
                    [place-holder] = "'Пароль'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.password" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     
      <amexio-fieldset [collapsible]="true" title="Фотография">
        <amexio-row>
        <amexio-column size="4" >
                    <img [src]="currentxUserInfo.photoUrl" style="border: 1px solid #000; max-width:128px; max-height:128px;"/>
        </amexio-column>
        <amexio-column size="8" >
                    <input type="file" ng2FileSelect [uploader]="uploader" />
        </amexio-column>
        </amexio-row>                                        
        </amexio-fieldset>
        
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'e-mail'" name ="eMail"  
                    [place-holder] = "'e-mail'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.eMail" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Телефон'" name ="phone"  
                    [place-holder] = "'Телефон'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.phone" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
  <amexio-date-time-picker   [field-label]="'Дата рождения'" 
        [time-picker]="false"  
        [date-picker]="true"  
        [(ngModel)]="currentxUserInfo.birthday"> 
 </amexio-date-time-picker> 
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Страна'" name ="country"  
                    [place-holder] = "'Страна'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.country" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Город'" name ="city"  
                    [place-holder] = "'Город'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.city" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Родной язык'" name ="nativeLanguage"  
                    [place-holder] = "'Родной язык'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.nativeLanguage" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
	 <amexio-dropdown 
	 [place-holder] = "'Уровень владения русским'"
	 name ="userSkill"
	 [field-label]= "'Уровень владения русским'"
            [allow-blank]="false" [error-msg] ="'Не задано: Уровень владения русским'" 
	 
	 [display-field]="'name'"
	 [value-field]="'id'"
	 [data]="AppService.ComboXUserSkillLevel"
	 
	 [(ngModel)]="currentxUserInfo.userSkill"
	 >
  </amexio-dropdown>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
 <amexio-number-input  [enable-popover]= "false" [field-label]="'Количество лет изучения русского'" name ="learningYears" 
                    [place-holder]="'Количество лет изучения русского'" 
            [allow-blank]="true" 
	 [(ngModel)]="currentxUserInfo.learningYears"
                    > 
 </amexio-number-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
                    <amexio-text-input [field-label]= "'Цель обучения'" name ="learningGoal"  
                    [place-holder] = "'Цель обучения'" 
                    [icon-feedback] = "true" [(ngModel)]="currentxUserInfo.learningGoal" >
                    </amexio-text-input>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
<amexio-dropdown 
	 [field-label]="'Принята политика ПД'" name ="pIaccept" 
                    [place-holder]="'Принята политика ПД'" 
	 [(ngModel)]="currentxUserInfo.pIaccept"
            [allow-blank]="false" [error-msg] ="'Не задано: Принята политика ПД'" 
	 [display-field]="'name'"
	 [value-field]="'id'"
	 [data]="AppService.enumYesNoCombo()"
	 >
</amexio-dropdown>
     </amexio-column></amexio-row>
     <amexio-row><amexio-column size="12" >
<amexio-dropdown 
	 [field-label]="'Принята политика HR'" name ="hRaccept" 
                    [place-holder]="'Принята политика HR'" 
	 [(ngModel)]="currentxUserInfo.hRaccept"
            [allow-blank]="false" [error-msg] ="'Не задано: Принята политика HR'" 
	 [display-field]="'name'"
	 [value-field]="'id'"
	 [data]="AppService.enumYesNoCombo()"
	 >
</amexio-dropdown>
     </amexio-column></amexio-row>
	</amexio-body> 
	<amexio-action> 
	<amexio-row> 
	<amexio-column size="12"> 
     <amexio-button  [label]="'Отмена'" (onClick)="opened = false;  refreshxUserInfo();" [type]="'secondary'" [tooltip]="'Отмена'" [icon]="'fa fa-times'"></amexio-button>
     <amexio-button  [label]="'Сохранить'" (onClick)="save(currentxUserInfo)" [type]="'success'" [tooltip]="'Сохранить'" [icon]="'fa fa-save'"></amexio-button>
	</amexio-column> 
	</amexio-row> 
	</amexio-action> 
</amexio-window> 
   
<!-- list Of row pane --> 
<amexio-card [show]="true" [header] ="true" [footer] ="false" > 
    <amexio-header> 
	<amexio-row> 
		<amexio-column size="12" > 
		<amexio-button [label]="'Создать'" [type]="'secondary'" [tooltip]="'Создать новую запись'" [icon]="'fa fa-plus'" (onClick)="onNew()"></amexio-button>
		<amexio-button [disabled]="currentxUserInfo.xUserInfoId==null" [label]="'Изменить'" (onClick)="onEdit(currentxUserInfo)" [type]="'secondary'" [tooltip]="'Изменить запись'" [icon]="'fa fa-edit'"></amexio-button>
     <amexio-button [disabled]="currentxUserInfo.xUserInfoId==null" [label]="'Удалить'" (onClick)="onDelete(currentxUserInfo)" [type]="'secondary'" [tooltip]="'Удалить запись'" [icon]="'fa fa-trash'"></amexio-button>
     <amexio-button  [label]="'Обновить'" (onClick)="refreshxUserInfo()" [type]="'secondary'" [tooltip]="'Обновить данные'" [icon]="'fa fa-refresh'"></amexio-button>
     <amexio-button  [label]="'Экспорт'" (onClick)="exportXSLX()" [type]="'secondary'" [tooltip]="'Экспорт данных'" [icon]="'fa fa-cloud'"></amexio-button>
		</amexio-column>
	</amexio-row> 
	</amexio-header> 
	<amexio-body> 
		<amexio-datagrid 
		  [title]="'Пользователь::Описание'" 
		  [page-size] = "10" 
		  [enable-data-filter]="false" 
		  [enable-checkbox]="false" 
		  [data]="xUserInfoArray" 
		  (selectedRowData)="onSelect($event)" 
		  (rowSelect)="onSelect($event)"> 
		  <amexio-data-table-column [data-index]="'family'" [data-type]="'string'" [hidden]="false" [text]="'Фамилия'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.family) ? ((row.family.length>100) ? row.family.substr(0,100)+'...' : row.family ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'name'" [data-type]="'string'" [hidden]="false" [text]="'Имя'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.name) ? ((row.name.length>100) ? row.name.substr(0,100)+'...' : row.name ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'middleName'" [data-type]="'string'" [hidden]="false" [text]="'Отчество'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.middleName) ? ((row.middleName.length>100) ? row.middleName.substr(0,100)+'...' : row.middleName ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'login'" [data-type]="'string'" [hidden]="false" [text]="'Имя для входа'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.login) ? ((row.login.length>100) ? row.login.substr(0,100)+'...' : row.login ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'password'" [data-type]="'string'" [hidden]="false" [text]="'Пароль'"></amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'photoUrl'" [data-type]="'string'" [hidden]="false" [text]="'Фотография'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.photoUrl) ? ((row.photoUrl.length>100) ? row.photoUrl.substr(0,100)+'...' : row.photoUrl ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'eMail'" [data-type]="'string'" [hidden]="false" [text]="'e-mail'"></amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'phone'" [data-type]="'string'" [hidden]="false" [text]="'Телефон'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.phone) ? ((row.phone.length>100) ? row.phone.substr(0,100)+'...' : row.phone ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'birthday'" [data-type]="'string'" [hidden]="false" [text]="'Дата рождения'"></amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'country'" [data-type]="'string'" [hidden]="false" [text]="'Страна'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.country) ? ((row.country.length>100) ? row.country.substr(0,100)+'...' : row.country ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'city'" [data-type]="'string'" [hidden]="false" [text]="'Город'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.city) ? ((row.city.length>100) ? row.city.substr(0,100)+'...' : row.city ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'nativeLanguage'" [data-type]="'string'" [hidden]="false" [text]="'Родной язык'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.nativeLanguage) ? ((row.nativeLanguage.length>100) ? row.nativeLanguage.substr(0,100)+'...' : row.nativeLanguage ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'userSkill_name'" [data-type]="'string'" [hidden]="false" [text]="'Уровень владения русским'"></amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'learningYears'" [data-type]="'number'" [hidden]="false" [text]="'Количество лет изучения русского'"></amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'learningGoal'" [data-type]="'string'" [hidden]="false" [text]="'Цель обучения'"> 
 		  <ng-template #amexioBodyTmpl let-column let-row="row">
             {{  ((row.learningGoal) ? ((row.learningGoal.length>100) ? row.learningGoal.substr(0,100)+'...' : row.learningGoal ) : '-') | removehtmltag }} 
           </ng-template>
		  </amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'pIaccept_name'" [data-type]="'string'" [hidden]="false" [text]="'Принята политика ПД'"></amexio-data-table-column> 
		  <amexio-data-table-column [data-index]="'hRaccept_name'" [data-type]="'string'" [hidden]="false" [text]="'Принята политика HR'"></amexio-data-table-column> 
		</amexio-datagrid> 
	</amexio-body> 
</amexio-card> 
 
<!-- confirm delete  dialog -->  
<amexio-window  [(show-window)]="confirmOpened" [closable]="false" [header]="true" [footer]="true" >  
     
    <amexio-header>
Удалить строку:  Пользователь::Описание ?
    </amexio-header> 
    <amexio-body> 
            Удалить запись: {{ ( (currentxUserInfo.family +'; '+  currentxUserInfo.name +'; '+  currentxUserInfo.middleName||'').length >100 ? (currentxUserInfo.family +'; '+  currentxUserInfo.name +'; '+  currentxUserInfo.middleName||'').substr(0,100)+'...' : (currentxUserInfo.family +'; '+  currentxUserInfo.name +'; '+  currentxUserInfo.middleName||'')) | removehtmltag }}?  
	</amexio-body> 
	<amexio-action> 
	<amexio-row> 
	<amexio-column size="12"> 
     <amexio-button  [label]="'Отмена'" (onClick)="confirmOpened = false" [type]="'secondary'" [tooltip]="'Отмена'" [icon]="'fa fa-times'"></amexio-button>
     <amexio-button  [label]="'Удалить'" (onClick)="onConfirmDeletion()" [type]="'danger'" [tooltip]="'Удалить'" [icon]="'fa fa-trash'"></amexio-button>
	</amexio-column> 
	</amexio-row> 
	</amexio-action> 
</amexio-window> 
 
